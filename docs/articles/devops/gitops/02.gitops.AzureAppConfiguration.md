---
title: "Adopter une démarche GitOps grâce à Azure App Configuration (Partie 2)"
summary: "Dans mon dernier talk \"GitOps, Continuous Delivery et les environnements : comment éviter l'enfer !\", un participant m'a fait remarquer qu'il serait bien de montrer concrètement comment mettre en place une démarche GitOps avec des outils modernes.
Etant un adepte des services managés d'Azure, je vous propose donc d'étudier comment mettre en place une démarche GitOps avec Azure App Configuration."
authors:
    - Philippe Morisseau
date: 2022-04-25
categorie: "Adopter une démarche GitOps"
image: img/cover/09.gitops.png
tags:
    - DevOps
    - GitOps
    - CI/CD
    - développement
    - Azure
    - PaaS
---

Dans la première partie nous avons vu comment utiliser **Azure App Configuration** avec différentes applications et contraintes : coffre-fort, **push** ou **pull** de la configuration.
Dans cette seconde partie nous allons voir ensemble comment utiliser les **repos git** et les pipelines **Azure DevOps** pour gérer et pousser la configuration vers **Azure App Configuration**.

## Rappel de la démarche GitOps

La démarche **GitOps** consiste à gérer la configuration des applications en utilisant un gestionnaire de source comme **git**.
**git** offre l'avantage de fournir un historique des modifications grâce aux **commits** et de pouvoir automatiser le déploiement de la configuration grâce aux pipelines de **CI/CD**.

Chaque modification de configuration produit un commit **git**. Celui-ci déclenche un pipeline qui va se charger de déployer la configuration.

A cela, on va pouvoir ajouter le **branching model** (**TBD**, **Gitflow**, **github flow**, ...) et le **semantic versioning**, pour conditionner le déploiement de la configuration.

## L'architecture (rappel)

L'objectif est d'utiliser conjointement **Azure DevOps** et **Azure App Configuration** pour distribuer la configuration aux différents éléments de notre application distribuée.

![Architecture 1](../../../img/tips.09.gitops.002.svg)

Nous allons pousser la configuration depuis **Azure DevOps** vers **Azure App Configuration** et configurer nos différents composants de notre architecture distribuée pour aller récupérer la configuration depuis ce dernier.

Si vous isolez d'un point de vue réseau **Azure App Configuration** en utilisant un **Private Endpoint**, il faudra veiller à utiliser des **Self-hosted** agents **Azure DevOps** pour déployer votre configuration.
Voici un exemple de schéma d'architecture avec une isolation réseau :

![Architecture 2](../../../img/tips.09.gitops.003.svg)

## L'implémentation Azure DevOps


## Conclusion

Dans cette première partie nous avons vu comment mettre en place **Azure App Configuration** avec nos applications. 
Nous verrons dans la seconde partie, comment automatiser la mise à jour de la configuration avec **Azure DevOps**.  

A suivre...

## Références

- [Microsoft : Azure App Configuration](https://docs.microsoft.com/en-us/azure/azure-app-configuration/)
- [Azure App Configuration refresh on demand](https://www.bustroker.com/notes/azure-app-configuration-refresh-on-demand/)
  
## Remerciements

- [Etienne Louise](https://www.linkedin.com/in/etienne-louise-78154063/) : pour la remarque qui m'a conduite à publier cet article.

_Rédigé par Philippe MORISSEAU, Publié le 25 Avril 2022._