
<!doctype html>
<html lang="fr" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://ineaweb.github.io/Blog/en/articles/tips/05.azuredevops.extension.agentless/">
      
      
        <link rel="prev" href="../04.sonarqube.managed/">
      
      
        <link rel="next" href="../06.azuredevops.ephemeralagents/">
      
      
      <link rel="icon" href="../../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.15">
    
    
      
        <title>Azure DevOps : Créer sa propre task agentless - Philippe MORISSEAU</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.7e359304.min.css">
      
        
        <link rel="stylesheet" href="../../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Poppins:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Poppins";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  <meta name="twitter:card" content="summary">
  <meta name="twitter:site" content="@morisseauphi" />
  <meta name="twitter:creator" content="@morisseauphi" />
  <meta property="og:title" content="Azure DevOps : Créer sa propre task agentless" />
  <meta name="google-site-verification" content="w_wkWaWiJN0xRkstken01Q7CmA4d_jKTliKb5ilkQlU" />
  
  <meta property="og:image" content="https://ineaweb.github.io/Blog/img/cover/05.azuredevops.extension.agentless.png" />
  <meta property="og:description" content="Le marketplace d'Azure DevOps propose déjà de nombreuses extensions gratuites et payantes. Mais il est possible que vous ne trouviez pas votre bonheur. Dans ce cas, vous pouvez vous même développer vos propres extensions. Je vous propose dans cet article d'étendre les capacités de vos pipelines de CI/CD avec une agentless task ou server task." />
  <meta property="og:url" content="https://ineaweb.github.io/Blog/en/articles/tips/05.azuredevops.extension.agentless/" />
  <meta name="Description" CONTENT="Le marketplace d'Azure DevOps propose déjà de nombreuses extensions gratuites et payantes. Mais il est possible que vous ne trouviez pas votre bonheur. Dans ce cas, vous pouvez vous même développer vos propres extensions. Je vous propose dans cet article d'étendre les capacités de vos pipelines de CI/CD avec une agentless task ou server task." />
  

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-T8TQW7CYM4"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-T8TQW7CYM4');
  </script>

  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#developper-sa-propre-tache-agentless" class="md-skip">
          Aller au contenu
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
  
  <header class="md-header" data-md-component="header">
    <nav class="md-header__inner md-grid" aria-label="header.title">
      <!--<img src="img/linkedInBandeau.png" />-->
      <a href="../../../.." title="Philippe MORISSEAU" class="md-header__button md-logo" aria-label="Philippe MORISSEAU" data-md-component="logo">
        
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

      </a>
      <label class="md-header__button md-icon" for="__drawer">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
      </label>
      <div class="md-header__title" data-md-component="header-title">
        <div class="md-header__ellipsis">
          <div class="md-header__topic">
            <span class="md-ellipsis">
              Philippe MORISSEAU
            </span>
          </div>
          <div class="md-header__topic" data-md-component="header-topic">
            <span class="md-ellipsis">
              
                Azure DevOps : Créer sa propre task agentless
              
            </span>
          </div>
        </div>
      </div>
      
      
        <div class="md-header__option">
          <div class="md-select">
            
            <button class="md-header__button md-icon" aria-label="select.language.title">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m12.87 15.07-2.54-2.51.03-.03A17.52 17.52 0 0 0 14.07 6H17V4h-7V2H8v2H1v2h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04M18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12m-2.62 7 1.62-4.33L19.12 17h-3.24Z"/></svg>
            </button>
            <div class="md-select__inner">
              <ul class="md-select__list">
                
                  <li class="md-select__item">
                    <a href="../../../.." hreflang="fr" class="md-select__link">
                      French
                    </a>
                  </li>
                  
                  <li class="md-select__item">
                    <a href="../../.." hreflang="en" class="md-select__link">
                      English
                    </a>
                  </li>
                  
              </ul>
            </div>
          </div>
        </div>
      
      
      
    </nav>
    
  </header>

    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../.." title="Philippe MORISSEAU" class="md-nav__button md-logo" aria-label="Philippe MORISSEAU" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Philippe MORISSEAU
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    French
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            French
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Accueil
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_2" >
        
          
          <label class="md-nav__link" for="__nav_1_2" id="__nav_1_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Articles
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_2">
            <span class="md-nav__icon md-icon"></span>
            Articles
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_2_1" >
        
          
          <label class="md-nav__link" for="__nav_1_2_1" id="__nav_1_2_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    A short story about the big Azure cloud
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_1_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_2_1">
            <span class="md-nav__icon md-icon"></span>
            A short story about the big Azure cloud
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../articles/assatbac/ep01/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Private Endpoint
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../articles/assatbac/ep02/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Private Endpoint VS Vnet Integration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../articles/assatbac/ep03/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SPN, SMI et UMI. Mais c'est quoi ces trucs ?
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../articles/assatbac/ep04/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cosmos DB, c'est comme l'orbe de Morag
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_2_2" >
        
          
          <label class="md-nav__link" for="__nav_1_2_2" id="__nav_1_2_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Révision du soir
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_1_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_2_2">
            <span class="md-nav__icon md-icon"></span>
            Révision du soir
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../articles/classroom/01.azureClassroom.VnetEndpointFirewall/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Private Endpoint, Service Endpoint, Dedicated Service, Service Tags & Firewall
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../articles/classroom/02.azureClassroom.batch/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Azure Batch, le mal-aimé
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_2_3" >
        
          
          <label class="md-nav__link" for="__nav_1_2_3" id="__nav_1_2_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Azure, Les exceptions qui font mal !
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_1_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_2_3">
            <span class="md-nav__icon md-icon"></span>
            Azure, Les exceptions qui font mal !
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../articles/exceptions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../articles/exceptions/01.azureException.acrAndAciInYourVnet/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Chapitre 1 : Azure Container Registry et Azure Container Instance dans votre Vnet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../articles/exceptions/02.azureException.aciWindowsWithVnet/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Chapite 2 : Azure Container Instance et Windows dans votre Vnet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../articles/exceptions/03.azureException.firewallAndRegion/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Chapitre 3 : Les firewall et les régions Azure
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_2_4" >
        
          
          <label class="md-nav__link" for="__nav_1_2_4" id="__nav_1_2_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Au secours, Le DevOps part en vrille !
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_1_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_2_4">
            <span class="md-nav__icon md-icon"></span>
            Au secours, Le DevOps part en vrille !
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../articles/devops/vrille/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_2_4_2" >
        
          
          <label class="md-nav__link" for="__nav_1_2_4_2" id="__nav_1_2_4_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Partie 1 : Pourquoi arrive-t-on aux limites du DevOps ?
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_1_2_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_2_4_2">
            <span class="md-nav__icon md-icon"></span>
            Partie 1 : Pourquoi arrive-t-on aux limites du DevOps ?
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../articles/devops/vrille/01.pourquoi.agilite/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Chapitre 1 : L'agilité
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../articles/devops/vrille/02.pourquoi.devops/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Chapitre 2 : Le DevOps
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../articles/devops/vrille/03.pourquoi.entropie/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Chapitre 3 : L'entropie
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_2_4_3" >
        
          
          <label class="md-nav__link" for="__nav_1_2_4_3" id="__nav_1_2_4_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Partie 2 : Comment passe-t-on au-delà des limites ?
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_1_2_4_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_2_4_3">
            <span class="md-nav__icon md-icon"></span>
            Partie 2 : Comment passe-t-on au-delà des limites ?
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../articles/devops/vrille/04.comment.machineetat/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Chapitre 1 : La machine à état
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../articles/devops/vrille/05.comment.build/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Chapitre 2 : Le build
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../articles/devops/vrille/06.comment.deploy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Chapitre 3 : Le déploiement
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../articles/devops/vrille/07.lapreuve/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    C'est possible, la preuve !
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_2_5" >
        
          
          <label class="md-nav__link" for="__nav_1_2_5" id="__nav_1_2_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Adopter une démarche GitOps
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_1_2_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_2_5">
            <span class="md-nav__icon md-icon"></span>
            Adopter une démarche GitOps
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../articles/devops/gitops/01.gitops.AzureAppConfiguration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Adopter une démarche GitOps grâce à Azure App Configuration (Partie 1)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../articles/devops/gitops/02.gitops.AzureAppConfiguration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Adopter une démarche GitOps grâce à Azure App Configuration (Partie 2)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../articles/devops/gitops/03.gitops.AzureAppConfiguration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Adopter une démarche GitOps grâce à Azure App Configuration (Partie 3)
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_2_6" >
        
          
          <label class="md-nav__link" for="__nav_1_2_6" id="__nav_1_2_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Le monde fantastique de Lemniscat
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_1_2_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_2_6">
            <span class="md-nav__icon md-icon"></span>
            Le monde fantastique de Lemniscat
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../articles/devops/lemniscat/01.lemniscat.microsoftfabric/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Permettre l'adoption de Fabric grâce à Lemniscat (Partie 1)
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_2_7" >
        
          
          <label class="md-nav__link" for="__nav_1_2_7" id="__nav_1_2_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Tips & tricks
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_1_2_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_2_7">
            <span class="md-nav__icon md-icon"></span>
            Tips & tricks
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../articles/tips/01.finops.ftpslowcost/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    L'astuce FinOps : Un serveur FTPS Low Cost
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../articles/tips/02.cosmosdb.waiting_partialupdate/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CosmosDB : En attendant le partial update
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../articles/tips/03.cosmosdb.calculatedPartitionKey/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CosmosDB : Une clé de partition calculée !
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../articles/tips/04.sonarqube.managed/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Déployer Sonarqube sur des services managés Azure.
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../articles/tips/05.azuredevops.extension.agentless/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Azure DevOps : Créer sa propre task agentless
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../articles/tips/06.azuredevops.ephemeralagents/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Azure DevOps : Vos propres agents à la demande dans votre SI
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../articles/tips/07.github.ephemeralactionsrunner/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GitHub : Vos propres runner à la demande dans votre SI
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../articles/tips/08.dockerhub.windowsServerCore2022/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Dockerhub : Votre Actions Runner et votre Azure DevOps Agent sous Windows Server Core 2022
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../articles/tips/09.azurefunction.limitlogs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    L'astuce FinOps : Limiter la verbosité de vos Azure Function
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../articles/tips/10.dockerhub.ubuntu22.04/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Votre agent Azure DevOps et votre runner Github avec Jammy la méduse.
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../about/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    A Propos
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    English
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            English
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Articles
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            Articles
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2_1" >
        
          
          <label class="md-nav__link" for="__nav_2_2_1" id="__nav_2_2_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    A short story about the big Azure cloud
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_1">
            <span class="md-nav__icon md-icon"></span>
            A short story about the big Azure cloud
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../assatbac/ep01/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Private Endpoint
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../assatbac/ep02/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Private Endpoint VS Vnet Integration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../assatbac/ep03/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SPN, SMI et UMI. But what are these things?
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../assatbac/ep04/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cosmos DB, it's like Morag's orb
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2_2" id="__nav_2_2_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Back to school
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_2">
            <span class="md-nav__icon md-icon"></span>
            Back to school
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../classroom/01.azureClassroom.VnetEndpointFirewall/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Private Endpoint, Service Endpoint, Dedicated Service, Service Tags & Firewall
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../classroom/02.azureClassroom.batch/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Azure Batch, le mal-aimé
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_2_3" id="__nav_2_2_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Azure, Exceptions that hurt!
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_3">
            <span class="md-nav__icon md-icon"></span>
            Azure, Exceptions that hurt!
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../exceptions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../exceptions/01.azureException.acrAndAciInYourVnet/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Chapitre 1 : Azure Container Registry et Azure Container Instance dans votre Vnet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../exceptions/02.azureException.aciWindowsWithVnet/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Chapite 2 : Azure Container Instance et Windows dans votre Vnet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../exceptions/03.azureException.firewallAndRegion/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Chapitre 3 : Les firewall et les régions Azure
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2_4" >
        
          
          <label class="md-nav__link" for="__nav_2_2_4" id="__nav_2_2_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Help, DevOps is going off road!
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_4">
            <span class="md-nav__icon md-icon"></span>
            Help, DevOps is going off road!
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../devops/vrille/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2_4_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2_4_2" id="__nav_2_2_4_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Part 1: Why are we reaching the limits of DevOps?
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_2_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_4_2">
            <span class="md-nav__icon md-icon"></span>
            Part 1: Why are we reaching the limits of DevOps?
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../devops/vrille/01.pourquoi.agilite/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Chapitre 1 : L'agilité
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../devops/vrille/02.pourquoi.devops/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Chapitre 2 : Le DevOps
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../devops/vrille/03.pourquoi.entropie/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Chapitre 3 : L'entropie
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2_4_3" >
        
          
          <label class="md-nav__link" for="__nav_2_2_4_3" id="__nav_2_2_4_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Part 2: How do we go beyond the limits?
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_2_4_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_4_3">
            <span class="md-nav__icon md-icon"></span>
            Part 2: How do we go beyond the limits?
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../devops/vrille/04.comment.machineetat/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Chapitre 1 : La machine à état
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../devops/vrille/05.comment.build/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Chapitre 2 : Le build
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../devops/vrille/06.comment.deploy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Chapitre 3 : Le déploiement
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../devops/vrille/07.lapreuve/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    It is possible, the proof!
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2_5" >
        
          
          <label class="md-nav__link" for="__nav_2_2_5" id="__nav_2_2_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Adopt a GitOps approach
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_2_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_5">
            <span class="md-nav__icon md-icon"></span>
            Adopt a GitOps approach
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../devops/gitops/01.gitops.AzureAppConfiguration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Adopt a GitOps approach with Azure App Configuration (Part 2)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../devops/gitops/02.gitops.AzureAppConfiguration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Adopt a GitOps approach with Azure App Configuration (Part 2)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../devops/gitops/03.gitops.AzureAppConfiguration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Adopt a GitOps approach with Azure App Configuration (Part 3)
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2_6" >
        
          
          <label class="md-nav__link" for="__nav_2_2_6" id="__nav_2_2_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    The fantastic world of Lemniscat
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_2_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_6">
            <span class="md-nav__icon md-icon"></span>
            The fantastic world of Lemniscat
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../devops/lemniscat/01.lemniscat.microsoftfabric/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Enabling Adoption of Fabric with Lemniscat (Part 1)
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2_7" checked>
        
          
          <label class="md-nav__link" for="__nav_2_2_7" id="__nav_2_2_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Tips & tricks
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_2_7_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_2_7">
            <span class="md-nav__icon md-icon"></span>
            Tips & tricks
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../01.finops.ftpslowcost/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    L'astuce FinOps : Un serveur FTPS Low Cost
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../02.cosmosdb.waiting_partialupdate/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CosmosDB : En attendant le partial update
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../03.cosmosdb.calculatedPartitionKey/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CosmosDB : Une clé de partition calculée !
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../04.sonarqube.managed/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Déployer Sonarqube sur des services managés Azure.
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Azure DevOps : Créer sa propre task agentless
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Azure DevOps : Créer sa propre task agentless
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table des matières">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table des matières
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#developper-sa-propre-tache-agentless" class="md-nav__link">
    <span class="md-ellipsis">
      Développer sa propre tâche agentless
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Développer sa propre tâche agentless">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#une-tache-agentless-cest-quoi-et-pourquoi-jen-aurais-besoin" class="md-nav__link">
    <span class="md-ellipsis">
      Une tâche agentless, c'est quoi et pourquoi j'en aurais besoin ?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pas-besoin-de-savoir-coder-pour-cela" class="md-nav__link">
    <span class="md-ellipsis">
      Pas besoin de savoir coder pour cela !
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Pas besoin de savoir coder pour cela !">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#le-fichier-vss-extensionjson" class="md-nav__link">
    <span class="md-ellipsis">
      Le fichier vss-extension.json
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#le-fichier-taskjson" class="md-nav__link">
    <span class="md-ellipsis">
      Le fichier task.json
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#creer-son-service-connection" class="md-nav__link">
    <span class="md-ellipsis">
      Créer son service connection
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Créer son service connection">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#les-limitations" class="md-nav__link">
    <span class="md-ellipsis">
      Les limitations
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#publier-sur-le-marketplace" class="md-nav__link">
    <span class="md-ellipsis">
      Publier sur le marketplace
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conclusion" class="md-nav__link">
    <span class="md-ellipsis">
      Conclusion
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    <span class="md-ellipsis">
      Références
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#remerciements" class="md-nav__link">
    <span class="md-ellipsis">
      Remerciements
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../06.azuredevops.ephemeralagents/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Azure DevOps: Your own on-demand agents in your corporate network
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../07.github.ephemeralactionsrunner/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GitHub : Your own on-demand runner in your corporate network
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../08.dockerhub.windowsServerCore2022/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Dockerhub: Your Actions Runner and Azure DevOps Agent on Windows Server Core 2022
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../09.azurefunction.limitlogs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    The FinOps tip: Limit the verbosity of your Azure Functions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../10.dockerhub.ubuntu22.04/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Your Azure DevOps Agent and Github Runner with Jammy Jellyfish.
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../about/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    About
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table des matières">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table des matières
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#developper-sa-propre-tache-agentless" class="md-nav__link">
    <span class="md-ellipsis">
      Développer sa propre tâche agentless
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Développer sa propre tâche agentless">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#une-tache-agentless-cest-quoi-et-pourquoi-jen-aurais-besoin" class="md-nav__link">
    <span class="md-ellipsis">
      Une tâche agentless, c'est quoi et pourquoi j'en aurais besoin ?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pas-besoin-de-savoir-coder-pour-cela" class="md-nav__link">
    <span class="md-ellipsis">
      Pas besoin de savoir coder pour cela !
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Pas besoin de savoir coder pour cela !">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#le-fichier-vss-extensionjson" class="md-nav__link">
    <span class="md-ellipsis">
      Le fichier vss-extension.json
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#le-fichier-taskjson" class="md-nav__link">
    <span class="md-ellipsis">
      Le fichier task.json
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#creer-son-service-connection" class="md-nav__link">
    <span class="md-ellipsis">
      Créer son service connection
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Créer son service connection">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#les-limitations" class="md-nav__link">
    <span class="md-ellipsis">
      Les limitations
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#publier-sur-le-marketplace" class="md-nav__link">
    <span class="md-ellipsis">
      Publier sur le marketplace
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conclusion" class="md-nav__link">
    <span class="md-ellipsis">
      Conclusion
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    <span class="md-ellipsis">
      Références
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#remerciements" class="md-nav__link">
    <span class="md-ellipsis">
      Remerciements
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  <h1>Azure DevOps : Créer sa propre task agentless</h1>

<div class="admonition important">
<p class="admonition-title">Important</p>
<p>This article written in French will be translated into English in the next few days. stay tuned ;-).</p>
</div>
<p>Cela fait maintenant des années que j'utilise quotidiennement <strong>Azure DevOps</strong>. J'ai pu connaitre sa version <strong>On-Premise</strong> nommée <strong>Team Foundation Server</strong>, puis sa première version <strong>SaaS</strong> nommée <strong>Visual Studio Team Services</strong>.</p>
<p>Vous ne le savez peut-être pas, mais il est possible d'étendre les fonctionnalités d'<strong>Azure DevOps</strong> au travers d'extensions. Ces extensions vont vous permettre d'étendre les capacités d'<strong>Azure DevOps</strong> pour répondre à vos enjeux de productivité.
Vous allez pouvoir personnaliser vos <strong>boards</strong> Azure, la gestion de vos <strong>repositories</strong> Azure, vos pipelines <strong>CI/CD</strong>, ...</p>
<p>Le <strong>marketplace</strong> d'<strong>Azure DevOps</strong> propose déjà de nombreuses extensions gratuites et payantes. Mais il est possible que vous ne trouviez pas votre bonheur. Dans ce cas, vous pouvez vous même développer vos propres extensions. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Les possibilités d'extensions sont énormes mais sont malheureusement très peu documentées. L'article <a href="https://docs.microsoft.com/en-us/previous-versions/azure/devops/extend/reference/targets/overview?WT.mc_id=AZ-MVP-5004832">Azure DevOps extensibility points</a> liste en partie les extensions possibles.</p>
</div>
<p>Je vous propose dans cet article d'étendre les capacités de vos pipelines de <strong>CI/CD</strong> avec une <strong>agentless task</strong> ou <strong>server task</strong>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>J'aurais préféré vous faire un comparatif de ce type de tâche entre les extensions <strong>Azure DevOps</strong> et les <strong>Github Action</strong>, malheureusement <strong>Github</strong> ne propose pas encore ce type de fonctionnalité. C'est bien dommage !</p>
</div>
<h2 id="developper-sa-propre-tache-agentless">Développer sa propre tâche agentless</h2>
<h3 id="une-tache-agentless-cest-quoi-et-pourquoi-jen-aurais-besoin">Une tâche agentless, c'est quoi et pourquoi j'en aurais besoin ?</h3>
<p>Lorsque vous exécutez un pipeline dans <strong>Azure DevOps</strong> pour compiler, analyser, tester ou déployer un composant vous utilisez un agent. Cet agent est une "machine" sur laquelle <strong>Azure DevOps</strong> va demander de réaliser des actions (une compilation .NET par exemple). Mais il est possible de demander à <strong>Azure DevOps</strong> d'exécuter lui-même certaines tâches. On parle alors d'<strong>agentless task</strong> ou de <strong>server task</strong>. </p>
<p>Les possibilités de ce type de tâches sont cependant limitées. Vous ne pourrez réaliser que 3 types d'opérations :</p>
<ul>
<li><strong>HttpRequest</strong> : pour réaliser une requête <strong>HTTP/S</strong>,</li>
<li><strong>ServiceBus</strong> : pour envoyer un message dans une file d'attente d'<strong>Azure Service Bus</strong>,</li>
<li><strong>HttpRequestChain</strong> : pour réaliser une suite de requêtes <strong>HTTP/S</strong>.</li>
</ul>
<p>Mais, dans de nombreux cas vous n'aurez besoin que de cela :</p>
<ul>
<li>Imaginons que vous souhaitez notifier automatiquement une application de votre SI d'une mise à jour applicative sur un environnement depuis votre pipeline Azure DevOps. Vous n'avez peut-être pas besoin de solliciter un agent pour cela ? Peut-être qu'une ou plusieurs requêtes <strong>HTTP/S</strong> seraient suffisantes.</li>
<li>Imaginons que vous souhaitez provisionner vos propres agents <strong>Azure DevOps</strong> éphémères (cf. <a href="../../classroom/02.azureClassroom.batch/">mon article</a>). Il serait préférable de se passer d'un agent pour en provisionner un autre !</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Les tâches <strong>agentless</strong> sont executées depuis les serveurs <strong>Azure DevOps</strong> qui ont des plages d'<strong>IP</strong> bien définies (cf. <a href="https://docs.microsoft.com/fr-fr/azure/devops/organizations/security/allow-list-ip-url?view=azure-devops&amp;tabs=IP-V4#inbound-connections&amp;WT.mc_id=AZ-MVP-5004832">documentation microsoft</a>). Elles offrent donc l'avantage d'être plus faciles à <strong>whitelister</strong> auprès des <strong>firewalls</strong> que les agents <strong>Microsoft Hosted</strong>.  </p>
</div>
<h3 id="pas-besoin-de-savoir-coder-pour-cela">Pas besoin de savoir coder pour cela !</h3>
<p>Et oui, l'implémentation de ce type de tâche ne nécessite aucune compétence dans un langage ou <strong>framework</strong> autre que le format "json".</p>
<p>Pour commencer, il vous faudra installer localement <strong><a href="https://nodejs.org/en/">Node.js</a></strong> puis installer <strong>tfx-cli</strong> via l'utilitaire <strong>npm</strong> installé avec <strong>Node.js</strong>.</p>
<p>Si vous êtes sur Linux/OSX :</p>
<div class="highlight"><pre><span></span><code>sudo npm install -g tfx-cli
</code></pre></div>
<p>Si vous êtes sur Windows :</p>
<div class="highlight"><pre><span></span><code>npm install -g tfx-cli
</code></pre></div>
<p>Ensuite dans votre répertoire de travail, vous allez créer 2 dossiers et 3 fichiers comme ceci :</p>
<div class="highlight"><pre><span></span><code>  |--- images                        
      |--- extension-icon.png         // l&#39;icône de votre extension
  |--- buildandreleasetask            
      |--- task.json                  // la tâche agentless 
  |--- vss-extension.json             // le manifeste de votre extension
</code></pre></div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>L'icône de votre extension doit être au format <strong>PNG</strong> et respecter une dimension bien précise : 128x128 pixels. En dehors de cela, vous être complètement libre.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Il n'est pas obligatoire de respecter les noms des dossiers et des fichiers. Mais pour plus de compréhension, je conseille de respecter une nomenclature proche de celle-ci.</p>
</div>
<p>Commençons par l'implémentation du manifeste.</p>
<h4 id="le-fichier-vss-extensionjson">Le fichier vss-extension.json</h4>
<p>Le fichier manifeste est un descriptif de l'extension. L'extension pouvant contenir plusieurs éléments, ce fichier va permettre de les lister et de préciser quelques informations obligatoires pour être sur le <strong>marketplace Azure Devops</strong>.</p>
<p>Ci-dessous un exemple de manifeste :</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;manifestVersion&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;test-push-to-storagequeue&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;publisher&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Pmorisseau&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;version&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;1.0.7&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;test-push-to-storagequeue&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;description&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;test-push-to-storagequeue&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;public&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;categories&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="s2">&quot;Azure Pipelines&quot;</span><span class="w"> </span><span class="p">],</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;targets&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"></span>
<span class="w">        </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Microsoft.VisualStudio.Services&quot;</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="p">],</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;icons&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="nt">&quot;default&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;images/icon.png&quot;</span><span class="w"></span>
<span class="w">    </span><span class="p">},</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;files&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"></span>
<span class="w">        </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;path&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;buildandreleasetask&quot;</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="p">],</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;contributions&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"></span>
<span class="w">        </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;sendtostoagequeue1&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;description&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Agentless task that push a message to an azure queue&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ms.vss-distributed-task.task&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;targets&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="s2">&quot;ms.vss-distributed-task.tasks&quot;</span><span class="w"> </span><span class="p">],</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;properties&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;buildandreleasetask&quot;</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w">        </span>
<span class="w">    </span><span class="p">]</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>
<p>Ce qu'il est important de retenir à propos des différents attributs :</p>
<ul>
<li><strong>id</strong> : doit être constant au fil des évolutions de l'extension. C'est lui qui permet d'identifier de façon unique l'extension,</li>
<li><strong>version</strong> : doit toujours être incrémenté avant d'être publié sur le <strong>marketplace</strong>,</li>
<li><strong>public</strong> : permet de rendre publique ou non l'extension. Une version publique de l'extension le restera même si ultérieurement vous la repassez en privée,</li>
<li><strong>files</strong> : doit lister tous les dossiers qui devront être intégrés dans l'extension,</li>
<li>
<p><strong>contribution</strong> :</p>
<ul>
<li><strong>id</strong> : est un identifiant unique et doit correspondre au nom de la tâche (attribut <strong>name</strong> dans le fichier <strong>task.json</strong>),</li>
<li><strong>type</strong> : doit être <code>ms.vss-distributed-task.task</code> dans le cas d'une <strong>agentless task</strong>,</li>
<li><strong>targets</strong> : doit contenir <code>ms.vss-distributed-task.tasks</code> dans le cas d'une <strong>agentless task</strong>,</li>
<li>
<p><strong>properties</strong> :</p>
<ul>
<li><strong>name</strong> : doit correspondre au dossier contenant le fichier <strong>task.json</strong>.</li>
</ul>
</li>
</ul>
</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Microsoft met à disposition une documentation détaillée <a href="https://docs.microsoft.com/fr-fr/azure/devops/extend/develop/manifest?view=azure-devops&amp;WT.mc_id=AZ-MVP-5004832">ici</a></p>
</div>
<p>Passons maintenant à l'implémentation de la tâche.</p>
<h4 id="le-fichier-taskjson">Le fichier task.json</h4>
<p>Imaginons que nous souhaitons réaliser une tâche permettant d'envoyer des messages dans une <strong>storage queue</strong>.
Voici ce que pourrait donner le fichier <strong>task.json</strong> :</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;$schema&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;https://raw.githubusercontent.com/Microsoft/azure-pipelines-task-lib/master/tasks.schema.json&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;bee81c33-f056-4721-a4fd-7141e07c42ad&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;sendtostoagequeue1&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;friendlyName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Send to Storage Queue&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;description&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;helpMarkDown&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Send to Storage Queue&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;category&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Azure Pipelines&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;author&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Pmorisseau&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;visibility&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"></span>
<span class="w">        </span><span class="s2">&quot;Build&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="s2">&quot;Release&quot;</span><span class="w"></span>
<span class="w">    </span><span class="p">],</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;runsOn&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"></span>
<span class="w">        </span><span class="s2">&quot;Server&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="s2">&quot;ServerGate&quot;</span><span class="w"></span>
<span class="w">    </span><span class="p">],</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;version&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="nt">&quot;Major&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="nt">&quot;Minor&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="nt">&quot;Patch&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">    </span><span class="p">},</span><span class="w">       </span>
<span class="w">    </span><span class="nt">&quot;instanceNameFormat&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Send message to queue : $(queueName)&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;inputs&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"></span>
<span class="w">        </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;storageAccountUrl&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;label&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Url du Storage Account&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;defaultValue&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;required&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w"></span>
<span class="w">        </span><span class="p">},</span><span class="w"></span>
<span class="w">        </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;queueName&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;label&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Nom de la file d&#39;attente&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;defaultValue&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;required&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w"></span>
<span class="w">        </span><span class="p">},</span><span class="w"></span>
<span class="w">        </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;storageAccountSasToken&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;label&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Clé d&#39;accès à votre file d&#39;attente&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;defaultValue&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;required&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w">        </span>
<span class="w">    </span><span class="p">],</span><span class="w"></span>
<span class="w">    </span><span class="nt">&quot;execution&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="nt">&quot;HttpRequest&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;Execute&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="nt">&quot;EndpointUrl&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;{{storageAccountUrl}}/{{queueName}}/messages$(storageAccountSasToken)&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="nt">&quot;Method&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;POST&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="nt">&quot;Body&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&lt;QueueMessage&gt;&lt;MessageText&gt;Lorem Ipsum dolor sit amet !&lt;/MessageText&gt;&lt;/QueueMessage&gt;&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="nt">&quot;Headers&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;{\n\&quot;Content-Type\&quot;:\&quot;application/xml\&quot;\n}&quot;</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span>
<span class="p">}</span><span class="w">    </span>
</code></pre></div>
<p>Ce qu'il est important de retenir c'est que :</p>
<ul>
<li>l'attribut <strong>id</strong> doit être unique et constant au fil des évolutions de la tâche,</li>
<li>l'attribut <strong>name</strong> doit correspondre à un <strong>id</strong> du nœud <strong>contributions</strong> dans le fichier <strong>vss-extension.json</strong>, </li>
<li>l'attribut <strong>runsOn</strong> doit contenir <strong>Server</strong> et/ou <strong>ServerGate</strong> pour être considéré comme une tâche <strong>agentless</strong>, </li>
<li>le nœud <strong>inputs</strong> doit contenir tous les paramètres de la tâche,</li>
<li>le nœud <strong>execution</strong> doit contenir la commande <strong>agentless</strong> à executer.  </li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Le schéma complet est disponible <a href="https://raw.githubusercontent.com/Microsoft/azure-pipelines-task-lib/master/tasks.schema.json">ici</a></p>
</div>
<p>Notre exemple ci-dessus, une fois déployé dans <strong>Azure DevOps</strong>, va mettre à disposition une nouvelle tâche qui, dans un pipeline classique, ressemblera à cela :</p>
<p><img alt="wiziwig" src="../../../../img/tipsandtricks.05.agentless.001.png" /></p>
<p>Et dans un pipeline yaml, à cela :</p>
<div class="highlight"><pre><span></span><code><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">task</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Pmorisseau.test-push-to-storagequeue.sendtostoagequeue1.sendtostoagequeue1@0</span><span class="w"></span>
<span class="w">  </span><span class="nt">displayName</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;Send</span><span class="nv"> </span><span class="s">message</span><span class="nv"> </span><span class="s">to</span><span class="nv"> </span><span class="s">queue</span><span class="nv"> </span><span class="s">:</span><span class="nv"> </span><span class="s">[your</span><span class="nv"> </span><span class="s">queue</span><span class="nv"> </span><span class="s">name]&#39;</span><span class="w"></span>
<span class="w">  </span><span class="nt">inputs</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="nt">storageAccountUrl</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;https://[your</span><span class="nv"> </span><span class="s">storage</span><span class="nv"> </span><span class="s">account</span><span class="nv"> </span><span class="s">name].queue.core.windows.net&#39;</span><span class="w"></span>
<span class="w">    </span><span class="nt">queueName</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;[your</span><span class="nv"> </span><span class="s">queue</span><span class="nv"> </span><span class="s">name]&#39;</span><span class="w"></span>
<span class="w">    </span><span class="nt">storageAccountSasToken</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;?sv=2019-02-02&amp;st=2021-12-12T10%3A51%3A39Z&amp;se=2022-12-13T10%3A51%3A00Z&amp;sp=raup&amp;sig=JTDK%2BDc16YpMtGTKkoqtLw1QVDOL7mnzTxOGEKwvWtY%3D&#39;</span><span class="w"></span>
</code></pre></div>
<p>Cependant, on est obligé de renseigner dans notre pipeline des données sensibles comme l'url ou la clé d'accès à notre api. Cela peut être considéré comme une faille de sécurité.</p>
<p>Pas de souci, on peut aussi créer ses propres <strong>service connections</strong>.</p>
<h3 id="creer-son-service-connection">Créer son service connection</h3>
<p>Tout d'abord, il va falloir modifier le fichier manifeste (<strong>vss-extension.json</strong>) pour déclarer le nouveau type de <strong>service connection</strong>. </p>
<p>Dans le nœud <strong>contributions</strong>, on va rajouter :</p>
<div class="highlight"><pre><span></span><code><span class="w">        </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;storagequeue&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;description&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Storage Queue&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ms.vss-endpoint.service-endpoint-type&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;targets&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"></span>
<span class="w">                </span><span class="s2">&quot;ms.vss-endpoint.endpoint-types&quot;</span><span class="w"></span>
<span class="w">            </span><span class="p">],</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;properties&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;storagequeue&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="nt">&quot;displayName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Storage Queue&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="nt">&quot;url&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                    </span><span class="nt">&quot;displayName&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Azure storage URL (without SAS token)&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                    </span><span class="nt">&quot;required&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w"></span>
<span class="w">                </span><span class="p">},</span><span class="w"></span>
<span class="w">                </span><span class="nt">&quot;inputDescriptors&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"></span>
<span class="w">                    </span><span class="p">{</span><span class="w"></span>
<span class="w">                        </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;queueName&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                        </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Queue Name&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                        </span><span class="nt">&quot;description&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Azure storage queue name&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                        </span><span class="nt">&quot;inputMode&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;textbox&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                        </span><span class="nt">&quot;isConfidential&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w"></span>
<span class="w">                        </span><span class="nt">&quot;validation&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                            </span><span class="nt">&quot;isRequired&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w"></span>
<span class="w">                            </span><span class="nt">&quot;dataType&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                            </span><span class="nt">&quot;maxLength&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">200</span><span class="w"></span>
<span class="w">                        </span><span class="p">}</span><span class="w"></span>
<span class="w">                    </span><span class="p">},</span><span class="w">   </span>
<span class="w">                    </span><span class="p">{</span><span class="w"></span>
<span class="w">                        </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;sasToken&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                        </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;SAS token&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                        </span><span class="nt">&quot;description&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Azure storage queue SAS token&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                        </span><span class="nt">&quot;inputMode&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;passwordbox&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                        </span><span class="nt">&quot;isConfidential&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w"></span>
<span class="w">                        </span><span class="nt">&quot;validation&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                            </span><span class="nt">&quot;isRequired&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w"></span>
<span class="w">                            </span><span class="nt">&quot;dataType&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                            </span><span class="nt">&quot;maxLength&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">500</span><span class="w"></span>
<span class="w">                        </span><span class="p">}</span><span class="w"></span>
<span class="w">                    </span><span class="p">}</span><span class="w">                                          </span>
<span class="w">                </span><span class="p">],</span><span class="w"></span>
<span class="w">                </span><span class="nt">&quot;dataSources&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"></span>
<span class="w">                    </span><span class="p">{</span><span class="w"> </span>
<span class="w">                        </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;TestConnection&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                        </span><span class="nt">&quot;endpointUrl&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;{{endpoint.url}}/{{endpoint.queueName}}/messages$(endpoint.sasToken)&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                        </span><span class="nt">&quot;resultSelector&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;xpath://QueueMessagesList&quot;</span><span class="w"></span>
<span class="w">                    </span><span class="p">}</span><span class="w"></span>
<span class="w">                </span><span class="p">],</span><span class="w">                                  </span>
<span class="w">                </span><span class="nt">&quot;authenticationSchemes&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"></span>
<span class="w">                    </span><span class="p">{</span><span class="w"></span>
<span class="w">                        </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ms.vss-endpoint.endpoint-auth-scheme-none&quot;</span><span class="w"></span>
<span class="w">                    </span><span class="p">}</span><span class="w"></span>
<span class="w">                </span><span class="p">]</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
</code></pre></div>
<p>Ce qu'il est important de retenir à propos des différents attributs :</p>
<ul>
<li><strong>id</strong> : est un identifiant unique,</li>
<li><strong>type</strong> : doit être <code>ms.vss-endpoint.service-endpoint-type</code>,</li>
<li><strong>targets</strong> : doit contenir <code>ms.vss-endpoint.endpoint-types</code>,</li>
<li>
<p><strong>properties</strong> :</p>
<ul>
<li><strong>url</strong> : corresponde à l'url du service,</li>
<li><strong>inputDescriptors</strong> : doit contenir l'ensemble des paramètres complémentaire à l'url,</li>
<li>
<p><strong>dataSource</strong> et l'item <strong>TestConnection</strong> (exactement orthographié comme cela) : permettent de définir le test de connexion du <strong>service connection</strong>,</p>
<ul>
<li><strong>endpointUrl</strong> : corresponde à l'url appelée lors du test de connexion,</li>
<li><strong>resultSelector</strong> : correpond à la vérification à réaliser sur la réponse lors du test de connexion,</li>
</ul>
</li>
<li>
<p><strong>authenticationSchemes</strong> : définit le mode d'authentification parmi :</p>
<ul>
<li><strong>Authentification de base</strong> avec le type <code>ms.vss-endpoint.endpoint-auth-scheme-basic</code> dans le cas d'une authentification avec un identifiant et un mot de passe encodé en base 64 dans l'en-tête <strong>HTTP</strong>,</li>
<li><strong>Authentification basée sur un jeton</strong> avec le type <code>ms.vss-endpoint.endpoint-auth-scheme-token</code> dans le cas d'une authentification avec un jeton dans l'en-tête <strong>HTTP</strong>,</li>
<li><strong>Authentification par certificat</strong>  avec le type <code>ms.vss-endpoint.endpoint-auth-scheme-cert</code>  dans le cas d'une authentification avec certificat,</li>
<li><strong>Sans athentification</strong> avec le type <code>ms.vss-endpoint.endpoint-auth-scheme-none</code> lorsqu'il n'y a pas d'authentification.</li>
</ul>
</li>
</ul>
</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Les différents types d'authentification sont décrits <a href="https://docs.microsoft.com/fr-fr/azure/devops/extend/develop/auth-schemes?view=azure-devops&amp;WT.mc_id=AZ-MVP-5004832">ici</a></p>
</div>
<p>Ensuite, il va falloir modifier le fichier <strong>task.json</strong> pour utiliser notre <strong>service connection</strong> en remplaçant le contenu du nœud <strong>inputs</strong> par :</p>
<div class="highlight"><pre><span></span><code><span class="w">        </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;connectedServiceName&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;aliases&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"></span>
<span class="w">                </span><span class="s2">&quot;serviceConnection&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="s2">&quot;genericService&quot;</span><span class="w"></span>
<span class="w">            </span><span class="p">],</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;connectedService:storagequeue&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;label&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Storage queue service connection&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;defaultValue&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;required&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;helpMarkDown&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Select an storage queue service connection&quot;</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
</code></pre></div>
<p>Il faudra veiller à ce que l'attribut <strong>type</strong> corresponde à <code>connectedService:[id du service connection dans le fichier manifeste]</code>.</p>
<p>Et modifier le contenu du nœud <strong>executions</strong> par :</p>
<div class="highlight"><pre><span></span><code><span class="w">        </span><span class="nt">&quot;HttpRequest&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="nt">&quot;Execute&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="nt">&quot;EndpointId&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;$(connectedServiceName)&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="nt">&quot;EndpointUrl&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;{{endpoint.url}}/{{endpoint.queueName}}/messages$(endpoint.sasToken)&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="nt">&quot;Method&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;POST&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="nt">&quot;Body&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&lt;QueueMessage&gt;&lt;MessageText&gt;Lorem Ipsum dolor sit amet !&lt;/MessageText&gt;&lt;/QueueMessage&gt;&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                </span><span class="nt">&quot;Headers&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;{\n\&quot;Content-Type\&quot;:\&quot;application/xml\&quot;\n}&quot;</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w">   </span>
</code></pre></div>
<p>Il faudra veiller à ce que :</p>
<ul>
<li>l'attribut <strong>EndpointId</strong> corresponde à <code>$([l'attribut name dans le nœud inputs])</code>,</li>
<li>les paramètres du <strong>service connection</strong> soient préfixés par "endpoint.".</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Il y a 2 syntaxes possibles pour faire référence à un paramètre :</p>
<ul>
<li><code>{{le_nom_de_l_attribut}}</code> : sera intéprété comme un texte devant être converti en url (<strong>httpencode</strong>).</li>
<li><code>$(le_nom_de_l_attribut)</code> : ne sera pas intéprété et donc sera utilisé tel quel.</li>
</ul>
<p>Dans notre exemple, le <strong>sasToken</strong> contenant un ensemble de paramètres au format <strong>Http query</strong>, il ne doit donc pas être converti.</p>
</div>
<p>Notre exemple n°2, une fois déployé dans <strong>Azure DevOps</strong>, va mettre à disposition un nouveau <strong>service connection</strong> qui ressemblera à cela :</p>
<p><img alt="wiziwig" src="../../../../img/tipsandtricks.05.agentless.002.png" /></p>
<p>Il modifiera aussi la tâche qui ressemblera à cela :</p>
<p><img alt="wiziwig2" src="../../../../img/tipsandtricks.05.agentless.003.png" /></p>
<p>Et dans un pipeline yaml, à cela :</p>
<div class="highlight"><pre><span></span><code><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">task</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Pmorisseau.test-push-to-storagequeue.sendtostoagequeue2.sendtostoagequeue2@0</span><span class="w"></span>
<span class="w">  </span><span class="nt">displayName</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;Send</span><span class="nv"> </span><span class="s">to</span><span class="nv"> </span><span class="s">Storage</span><span class="nv"> </span><span class="s">Queue&#39;</span><span class="w"></span>
<span class="w">  </span><span class="nt">inputs</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="nt">serviceConnection</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">myqueue</span><span class="w"></span>
</code></pre></div>
<p>Maintenant, le pipeline ne contient plus de données "sensibles".</p>
<h4 id="les-limitations">Les limitations</h4>
<p>Les limitations d'implémentation des <strong>service connections</strong> sont nombreuses et parfois un peu frustrantes :</p>
<ul>
<li>les paramètres décrits dans le nœud <strong>inputDescriptors</strong> ne peuvent pas être utilisés si l'attribut <strong>isConfidential</strong> est définit à "true",</li>
<li>les modes d'authentification permis sont trop peu nombreux. Il aurait été bienvenue de permettre les authentifications modernes comme l'<strong>oauth 2.0</strong> et les authentifications simples comme l'<strong>apikey</strong> ou le <strong>sasToken</strong> dans l'url de la requête <strong>HTTP</strong>,</li>
<li>l'<strong>inputMode password</strong> ne sert à rien dans le nœud <strong>inputDescriptors</strong>.</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Dans notre exemple le <strong>sasToken</strong> de notre storage queue restera toujours en clair. </p>
</div>
<p>Maintenant que nous avons preparé notre extension avec notre nouvelle tâche <strong>agentless</strong>, il ne nous reste plus qu'à la publier ! </p>
<h3 id="publier-sur-le-marketplace">Publier sur le marketplace</h3>
<p>Pour pouvoir utiliser nos extensions sur <strong>Azure DevOps</strong>, il faut préalablement publier celle-ci sur le <strong>marketplace</strong> d'<strong>Azure DevOps</strong>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Il vous faut obligatoirement un compte déjà enregistré dans une organisation <strong>Azure DevOps</strong> pour publier sur le <strong>marketplace</strong>.</p>
</div>
<ol>
<li>Connectez-vous à votre organisation <strong>Azure DevOps</strong> : https://dev.azure.com/[votre organisation]</li>
<li>
<p>Une fois connecté, générez un <strong>personal acces token</strong> en cliquant sur <strong>User settings</strong> puis sur <strong>Personal access tokens</strong>.</p>
<p><img alt="linktopat" src="../../../../img/tipsandtricks.05.agentless.004.png" /></p>
</li>
<li>
<p>Créez un nouveau <strong>Personal access token</strong> en précisant bien <strong>All accessible organisations</strong> et en cochant <strong>Manage</strong> sous <strong>Marketplace</strong>.</p>
<p><img alt="newpat" src="../../../../img/tipsandtricks.05.agentless.005.png" /></p>
</li>
<li>
<p>Cliquez sur <strong>Create</strong> et notez bien la clé retournée, c'est votre <strong>Personal access token</strong>.</p>
</li>
<li>Exécutez la commande ci-dessous pour packager l'extension :
   <div class="highlight"><pre><span></span><code> tfx extension create --manifest-globs vss-extension.json
</code></pre></div></li>
<li>Exécutez la commande ci-dessous pour publier l'extension sur le marketplace :
   <div class="highlight"><pre><span></span><code> tfx extension publish --manifest-globs vss-extension.json --share-with <span class="o">[</span>liste des organisations avec qui vous voulez partager votre extension <span class="o">(</span>séparé par une virgule<span class="o">)]</span>
</code></pre></div></li>
<li>durant le processus de publication, il vous sera demandé de saisir votre <strong>personal access token</strong>.</li>
</ol>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>Votre <strong>personal access token</strong> a systématiquement une date d'expiration. Vous recevrez une notification par email (envoyé par azuredevops@microsoft.com) 5 jours avant l'expiration.</p>
<p><img alt="renew" src="../../../../img/tipsandtricks.05.agentless.006.png" /></p>
<p>Pensez à renouveler votre <strong>token</strong> !</p>
</div>
<p>Votre extension est maintenant publiée. </p>
<p>Vous pouvez consulter celle-ci directement sur le <a href="https://marketplace.visualstudio.com/azuredevops">marketplace</a>. Pour cela, une fois connecté, cliquez sur <strong>Publish extensions</strong>.</p>
<h2 id="conclusion">Conclusion</h2>
<p>Bien que les capacités d'<strong>Azure DevOps</strong> peuvent être étendues sur de nombreux aspects, il s'avère que la documentation Microsoft pour aider les développeurs est souvent éparpillée et/ou incomplète.</p>
<p>Dans cet article, j'ai essayé de vous montrer un exemple simple d'extension. Pour cela, bien que je connaisse le système d'extension, j'ai dû m'y reprendre de nombreuses fois pour avoir une extension opérationnelle. Les nombreuses limitations sont souvent des facteurs de frustration.</p>
<p>Cependant, les <strong>github action</strong> ne permettant pas aujourd'hui ce type de tâche, nous n'avons pas vraiment le choix avec les outils Microsoft... Il reste encore beaucoup de choses à améliorer de ce point de vue !</p>
<h2 id="references">Références</h2>
<ul>
<li><a href="https://docs.microsoft.com/en-us/previous-versions/azure/devops/extend/reference/targets/overview?WT.mc_id=AZ-MVP-5004832">Azure DevOps extensibility points</a></li>
<li><a href="https://github.com/Microsoft/azure-pipelines-tasks/blob/master/docs/authoring/servertaskauthoring.md">Server Task Authoring</a></li>
<li><a href="https://github.com/microsoft/tfs-cli">Tfx cli</a></li>
<li><a href="https://docs.microsoft.com/fr-fr/azure/devops/extend/develop/add-build-task?view=azure-devops&amp;WT.mc_id=AZ-MVP-5004832">Ajouter une extension de tâche de pipeline personnalisée</a></li>
<li><a href="https://raw.githubusercontent.com/Microsoft/azure-pipelines-task-lib/master/tasks.schema.json">Task Json Schema</a></li>
<li><a href="https://docs.microsoft.com/fr-fr/azure/devops/extend/develop/manifest?view=azure-devops&amp;WT.mc_id=AZ-MVP-5004832">Référence du manifeste de l’extension</a></li>
<li><a href="https://docs.microsoft.com/fr-fr/azure/devops/extend/develop/auth-schemes?view=azure-devops&amp;WT.mc_id=AZ-MVP-5004832">Schémas d’authentification du point de terminaison de service</a></li>
</ul>
<h2 id="remerciements">Remerciements</h2>
<ul>
<li><a href="https://www.linkedin.com/in/mouchritoussama/">Oussama Mouchrit</a> : pour la relecture</li>
<li><a href="https://www.linkedin.com/in/laurent-mondeil-0a87a743/">Laurent Mondeil</a> : pour la relecture</li>
<li><a href="https://twitter.com/michael_maillot">Michael Maillot</a> : pour la relecture</li>
<li><a href="https://www.linkedin.com/in/%E2%99%A0-fabrice-weinling-%E2%99%A0-414187114/">Fabrice Weinling</a> : pour la relecture</li>
</ul>
<p><em>Rédigé par Philippe MORISSEAU, Publié le 14 Décembre 2021</em></p>







  
  






                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://twitter.com/morisseauphi" target="_blank" rel="noopener" title="twitter.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.linkedin.com/in/pmorisseau" target="_blank" rel="noopener" title="www.linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../../..", "features": [], "search": "../../../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copi\u00e9 dans le presse-papier", "clipboard.copy": "Copier dans le presse-papier", "search.result.more.one": "1 de plus sur cette page", "search.result.more.other": "# de plus sur cette page", "search.result.none": "Aucun document trouv\u00e9", "search.result.one": "1 document trouv\u00e9", "search.result.other": "# documents trouv\u00e9s", "search.result.placeholder": "Taper pour d\u00e9marrer la recherche", "search.result.term.missing": "Non trouv\u00e9", "select.version": "S\u00e9lectionner la version"}}</script>
    
    
      <script src="../../../../assets/javascripts/bundle.bd41221c.min.js"></script>
      
        <script src="../../../../assets/javascripts/mmrls.js"></script>
      
    
  </body>
</html>